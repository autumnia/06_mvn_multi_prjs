# docker 설정

## 1. 네트워크 설정
docker network create  elastic-network
docker network connect elastic-network elasticsearch
docker network connect elastic-network logstash

## 2. Elastic Search
```docker
docker run -d --name elasticsearch -h elasticsearch -p 9200:9200 -e "discovery.type=single-node" -e "xpack.security.enabled=false" -e "xpack.security.http.ssl.enabled=false" docker.elastic.co/elasticsearch/elasticsearch:8.10.0
```

## 3. logstash 
logstash.conf 작성
```docker
docker run -d --name logstash -h logstash -p 5044:5044 -p 9600:9600 -v ./logstash.conf:/usr/share/logstash/pipeline/logstash.conf docker.elastic.co/logstash/logstash:8.10.0
```

## 4. pom.xml 추가
```xml
<dependency>
    <groupId>net.logstash.logback</groupId>
    <artifactId>logstash-logback-encoder</artifactId>
    <version>7.4</version>
</dependency>
```

## 5. logback.xml 추가
```xml
    <!-- Logstash로 전송할 Appender -->
    <appender name="LOGSTASH" class="net.logstash.logback.appender.LogstashTcpSocketAppender">
        <destination>localhost:5044</destination>
        <encoder class="net.logstash.logback.encoder.LogstashEncoder" />
    </appender>

    <appender-ref ref="LOGSTASH" />
```